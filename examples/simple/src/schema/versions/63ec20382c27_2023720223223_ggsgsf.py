# Code generated by github.com/lolopinto/ent/ent, DO NOT edit.

"""ggsgsf

Revision ID: 63ec20382c27
Revises: 466d862abc01
Create Date: 2023-07-20 22:32:23.659574+00:00

"""
from alembic import op
import sqlalchemy as sa
import auto_schema
from sqlalchemy.dialects import postgresql


# revision identifiers, used by Alembic.
revision = '63ec20382c27'
down_revision = '466d862abc01'
branch_labels = None
depends_on = None


def upgrade():
    op.execute_sql(
        """
        CREATE OR REPLACE FUNCTION users_notify()
RETURNS trigger AS
$$
BEGIN
  PERFORM pg_notify(’users_created’, NEW.id::text);
  RETURN NEW;
END;
$$ LANGUAGE 'plpgsql';
 
CREATE OR REPLACE TRIGGER users_created BEFORE INSERT OR UPDATE
       ON users
       FOR EACH ROW EXECUTE PROCEDURE users_notify();
"""
        )


def downgrade():
    op.execute_sql("DROP TRIGGER users_created ON users")
    op.execute_sql("DROP FUNCTION users_notify")
