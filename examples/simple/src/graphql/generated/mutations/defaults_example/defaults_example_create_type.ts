/**
 * Copyright whaa whaa
 * Generated by github.com/lolopinto/ent/ent, DO NOT EDIT.
 */

import type {
  GraphQLFieldConfig,
  GraphQLFieldConfigMap,
  GraphQLInputFieldConfigMap,
  GraphQLResolveInfo,
} from "graphql";
import type { RequestContext } from "@snowtop/ent";
import type { DefaultsExample } from "../../../../ent";
import type { DefaultsExampleCreateInput } from "../../../../ent/defaults_example/actions/create_defaults_example_action";
import type { ExampleViewer as ExampleViewerAlias } from "../../../../viewer/viewer";
import {
  GraphQLID,
  GraphQLInputObjectType,
  GraphQLInt,
  GraphQLList,
  GraphQLNonNull,
  GraphQLObjectType,
  GraphQLString,
} from "graphql";
import { mustDecodeNullableIDFromGQLID } from "@snowtop/ent/graphql";
import CreateDefaultsExampleAction from "../../../../ent/defaults_example/actions/create_defaults_example_action";
import { DefaultsPayloadInputType } from "../input/defaults_payload_input_type";
import { DefaultsExampleType } from "../../../resolvers";

interface customDefaultsExampleCreateInput extends DefaultsExampleCreateInput {
  creatorId?: string;
}

interface DefaultsExampleCreatePayload {
  defaultsExample: DefaultsExample;
}

export const DefaultsExampleCreateInputType = new GraphQLInputObjectType({
  name: "DefaultsExampleCreateInput",
  fields: (): GraphQLInputFieldConfigMap => ({
    creatorId: {
      type: GraphQLID,
    },
    name: {
      type: new GraphQLNonNull(GraphQLString),
    },
    perHour: {
      type: GraphQLInt,
    },
    hourlyLimit: {
      type: GraphQLInt,
    },
    payloads: {
      type: new GraphQLList(new GraphQLNonNull(DefaultsPayloadInputType)),
    },
  }),
});

export const DefaultsExampleCreatePayloadType = new GraphQLObjectType({
  name: "DefaultsExampleCreatePayload",
  fields: (): GraphQLFieldConfigMap<
    DefaultsExampleCreatePayload,
    RequestContext<ExampleViewerAlias>
  > => ({
    defaultsExample: {
      type: new GraphQLNonNull(DefaultsExampleType),
    },
  }),
});

export const DefaultsExampleCreateType: GraphQLFieldConfig<
  undefined,
  RequestContext<ExampleViewerAlias>,
  { [input: string]: customDefaultsExampleCreateInput }
> = {
  type: new GraphQLNonNull(DefaultsExampleCreatePayloadType),
  args: {
    input: {
      description: "",
      type: new GraphQLNonNull(DefaultsExampleCreateInputType),
    },
  },
  resolve: async (
    _source,
    { input },
    context: RequestContext<ExampleViewerAlias>,
    _info: GraphQLResolveInfo,
  ): Promise<DefaultsExampleCreatePayload> => {
    const defaultsExample = await CreateDefaultsExampleAction.create(
      context.getViewer(),
      {
        creatorId: mustDecodeNullableIDFromGQLID(
          input.creatorId?.toString() ?? input.creatorId,
        ),
        name: input.name,
        perHour: input.perHour,
        hourlyLimit: input.hourlyLimit,
        payloads: input.payloads,
      },
    ).saveX();
    return { defaultsExample: defaultsExample };
  },
};
