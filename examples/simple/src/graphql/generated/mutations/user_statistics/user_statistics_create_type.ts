/**
 * Copyright whaa whaa
 * Generated by github.com/lolopinto/ent/ent, DO NOT EDIT.
 */

import type {
  GraphQLFieldConfig,
  GraphQLFieldConfigMap,
  GraphQLInputFieldConfigMap,
  GraphQLResolveInfo,
} from "graphql";
import type { RequestContext } from "@snowtop/ent";
import type { UserStatistics } from "../../../../ent";
import type { UserStatisticsCreateInput } from "../../../../ent/user_statistics/actions/create_user_statistics_action";
import type { ExampleViewer as ExampleViewerAlias } from "../../../../viewer/viewer";
import {
  GraphQLID,
  GraphQLInputObjectType,
  GraphQLInt,
  GraphQLNonNull,
  GraphQLObjectType,
} from "graphql";
import { mustDecodeIDFromGQLID } from "@snowtop/ent/graphql";
import CreateUserStatisticsAction from "../../../../ent/user_statistics/actions/create_user_statistics_action";
import { UserStatisticsType } from "../../../resolvers";

interface customUserStatisticsCreateInput extends UserStatisticsCreateInput {
  userId: string;
}

interface UserStatisticsCreatePayload {
  userStatistics: UserStatistics;
}

export const UserStatisticsCreateInputType = new GraphQLInputObjectType({
  name: "UserStatisticsCreateInput",
  fields: (): GraphQLInputFieldConfigMap => ({
    userId: {
      type: new GraphQLNonNull(GraphQLID),
    },
    authCodeEmailsSent: {
      type: GraphQLInt,
    },
  }),
});

export const UserStatisticsCreatePayloadType = new GraphQLObjectType({
  name: "UserStatisticsCreatePayload",
  fields: (): GraphQLFieldConfigMap<
    UserStatisticsCreatePayload,
    RequestContext<ExampleViewerAlias>
  > => ({
    userStatistics: {
      type: new GraphQLNonNull(UserStatisticsType),
    },
  }),
});

export const UserStatisticsCreateType: GraphQLFieldConfig<
  undefined,
  RequestContext<ExampleViewerAlias>,
  { [input: string]: customUserStatisticsCreateInput }
> = {
  type: new GraphQLNonNull(UserStatisticsCreatePayloadType),
  args: {
    input: {
      description: "",
      type: new GraphQLNonNull(UserStatisticsCreateInputType),
    },
  },
  resolve: async (
    _source,
    { input },
    context: RequestContext<ExampleViewerAlias>,
    _info: GraphQLResolveInfo,
  ): Promise<UserStatisticsCreatePayload> => {
    const userStatistics = await CreateUserStatisticsAction.create(
      context.getViewer(),
      {
        userId: mustDecodeIDFromGQLID(input.userId.toString()),
        authCodeEmailsSent: input.authCodeEmailsSent,
      },
    ).saveX();
    return { userStatistics: userStatistics };
  },
};
