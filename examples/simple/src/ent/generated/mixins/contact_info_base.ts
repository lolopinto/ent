/**
 * Copyright whaa whaa
 * Generated by github.com/lolopinto/ent/ent, DO NOT EDIT.
 */

import type { Data, Ent, ID, Viewer } from "@snowtop/ent";
import type { ContactInfoExtra } from "../types";
import type { ExampleViewer as ExampleViewerAlias } from "../../../viewer/viewer";
import { Contact } from "../../internal";

export interface IContactInfoBase<
  TViewer extends ExampleViewerAlias = ExampleViewerAlias,
> extends Ent<TViewer> {
  _extra: ContactInfoExtra | null;
  contactId: ID;
  ownerId: ID;
  loadContact(): Promise<Contact | null>;
  loadContactX(): Promise<Contact>;
}

type Constructor<T extends IContactInfoBase = IContactInfoBase> = new (
  ...args: any[]
) => T;

function extractFromArgs<TViewer extends Viewer, TData extends Data>(
  args: any[],
): { viewer: TViewer; data: TData } {
  if (args.length !== 2) {
    throw new Error("args should be length 2");
  }
  return {
    viewer: args[0],
    data: args[1],
  };
}

export function ContactInfoBaseMixin<T extends Constructor>(BaseClass: T) {
  return class ContactInfoBaseMixin extends BaseClass {
    readonly _extra: ContactInfoExtra | null;
    readonly contactId: ID;
    readonly ownerId: ID;
    constructor(...args: any[]) {
      super(...args);
      const { data } = extractFromArgs(args);
      this._extra = data.extra;
      this.contactId = data.contact_id;
      this.ownerId = data.owner_id;
    }
  };
}
